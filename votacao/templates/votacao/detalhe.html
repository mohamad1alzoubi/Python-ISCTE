{% extends 'votacao/base.html' %}

{% block title %}{{ questao.questao_texto }} - Sistema de Votação{% endblock %}

{% block content %}
<h2>{{ questao.questao_texto }}</h2>
<p><em>Publicada em: {{ questao.pub_data|date:"d/m/Y H:i" }}</em></p>

{% if error_message %}
    <p style="color: red; background-color: #ffe6e6; padding: 10px; border-radius: 4px;">
        <strong>Erro:</strong> {{ error_message }}
    </p>
{% endif %}

{% if questao.opcao_set.all %}
    <form action="{% url 'votacao:votar' questao.id %}" method="post">
        {% csrf_token %}
        <fieldset>
            <legend>Escolha uma opção:</legend>
            {% for opcao in questao.opcao_set.all %}
                <div class="option">
                    <input type="radio" name="opcao" id="opcao{{ forloop.counter }}" value="{{ opcao.id }}" />
                    <label for="opcao{{ forloop.counter }}">{{ opcao.opcao_texto }}</label>
                </div>
            {% endfor %}
        </fieldset>
        <input type="submit" value="Votar" class="vote-button" style="margin-top: 15px;" />
    </form>
    
    <div class="results">
        <h3>Resultados Atuais:</h3>
        {% for opcao in questao.opcao_set.all %}
            <div class="option">
                <span>{{ opcao.opcao_texto }}</span>
                <span style="float: right; color: #666;">{{ opcao.votos }} voto{{ opcao.votos|pluralize:"s" }}</span>
            </div>
        {% endfor %}
    </div>
{% else %}
    <p><em>Nenhuma opção disponível para esta questão.</em></p>
{% endif %}

<div style="margin-top: 30px; text-align: center;">
    <a href="{% url 'votacao:questoes' %}" class="vote-button" style="text-decoration: none; display: inline-block;">
        Voltar à Lista
    </a>
    <a href="{% url 'votacao:index' %}" class="vote-button" style="text-decoration: none; display: inline-block; margin-left: 10px;">
        Início
    </a>
</div>
{% endblock %}
